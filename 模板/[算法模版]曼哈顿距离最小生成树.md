# [算法模版]曼哈顿距离最小生成树

## 算法描述

先说结论。做法就是把平面等分成8块。可以证明以$i$为坐标原点的八个区域中，每个区域都只有离$i$最近的点可能和$i$连边。一旦我们确定了这些点，我们就把边数压缩到了$8n$，就可以直接跑了。

对于在以$i$为坐标原点$y$轴正半轴右边那个区域（右上角），区域内离他最近的点$j$满足$y_j-x_j\geq y_i-x_i$，同时保证$y_j+x_j$最小。

第一个限制保证了在右上角那个区间，第二个保证了距离最近。

我们就可以用数据结构来维护这个东西。（把$y-x$离散一下，维护$[y-x,\infty]$中$y+x$最小的是多少就好了）

对于其他区域最近点的求解，我们可以把它对称到右上角的区域来解决。

## 证明

下面我们将证明 

> 以$i$为坐标原点的八个区域中，每个区域都只有离$i$最近的点可能和$i$连边

[曼哈顿距离最小生成树](https://riteme.site/blog/2017-1-17/manhattan-mst.html#fn:cut)

## 例题

[Dragonstone](https://www.codechef.com/problems/DRAGONST)

这道题还要用到一个结论：要令两个点之间路径上最大边最小，选择的路径就是最小生成树上路径。（因为如果最大的路径不是最小生成树上的路径一定不优）