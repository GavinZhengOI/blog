# 数学基础

## 裴蜀定理和exgcd（扩展欧几里得）

首先，有个神奇的东西叫裴蜀等式/裴蜀定理。

这里有一个不定方程：$ax+by=m$。

裴蜀定理就是如果上面这个不定方程有解当且仅当$gcd(a,b)|m$。且当这个不定方程有解时，一定有无数多组解。

证明：（咕咕咕）

对于方程：$ax+by=gcd(a,b)$，我们可以用exgcd算法找到这个式子的一组解，然后就能就能推出$ax+by=m$的解。

而$ax+by=gcd(a,b)$可以通过递归构造解来解决：
$$
a  \bmod b=a-\left \lfloor \frac{a}{b} \right \rfloor b
\\假设存在x',y'使得x'b+y'(a \bmod b)=d
\\则x'b+y'(a-\left \lfloor \frac{a}{b} \right \rfloor b)=d
\\把上面这个式子化成ay'+b(x'-y'\left \lfloor \frac{a}{b} \right \rfloor)
\\然后我们可以从这一层推出上一层的解x=y',y=(x'-y'\left \lfloor \frac{a}{b} \right \rfloor)
$$
特别的，当g欧几里得算法递归到最低一层时，是这个样子的：$gcd(c,d),d=0$

那么对于这种情况我们就可直接得出当前这一层对应的不定方程$cx''+dy''=gcd(c,d)=c$的解：$x''=1,y''=0$然后就可以倒推出上一层的解。

代码(引自[KSKUN——欧几里得算法和扩展欧几里得算法](<https://ksmeow.moe/euclid/>))：

```cpp
int exgcd(int a, int b, int &x, int &y) {
    if(b == 0) {
        x = 1; // 设置b=0时的特殊解 
        y = 0;
        return a;
    }
    int ans = exgcd(b, a % b, x, y);
    int t = x; // 将x2, y2换算成x1, y1
    x = y;
    y = t - a / b * y;
    return ans;
}
```

## 线性同余方程

