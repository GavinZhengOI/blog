# [算法模版]莫队

莫队是一个极其有意思的玄学算法，常用于暴力骗分。

首先，莫队是通过暴力转移区间来求解答案的。那么显然，完成单组询问复杂度是$O\left(x^{*}(|r 1-r 2|+|(l1-l2 |))\right.$。其中$x$为每次的转移复杂度。

莫队算法的总复杂度是$n \sqrt m$。（虽然我也不知道怎么证的）

莫队的精髓在于将序列分块，块的大小也因题而异。对于不带修的普通莫队，最优分块方法是

![w0W51WQRS3GywOOWMyWGgw_mini_1](/Users/gavinzheng/Documents/GitHub/blog/模板/pic/莫队-1.jpg)

而对于带修改的莫队，分块方法是：

![屏幕快照 2019-07-30 下午8.15.16](/Users/gavinzheng/Documents/GitHub/blog/模板/pic/莫队-2.png)

带修莫队只要添加一个第三关键字——按照时间排序即可。

再介绍一种极其玄学的奇偶优化：

我们只需把

```cpp
int cmp(query a, query b) {
    return belong[a.l] == belong[b.l] ? a.r < b.r : belong[a.l] < belong[b.l];
}
```

换成

```cpp
int cmp(query a, query b) {
    return (belong[a.l] ^ belong[b.l]) ? belong[a.l] < belong[b.l] : ((belong[a.l] & 1) ? a.r < b.r : a.r > b.r);
}
```

即可。

具体原理见：[莫队——奇偶优化详解](https://blog.csdn.net/weixin_43907802/article/details/86773471)

***

这里放一道莫队+玄学优化卡常能过的暴力题。

[[SDOI2009]HH的项链](https://www.luogu.org/problem/P1972)

